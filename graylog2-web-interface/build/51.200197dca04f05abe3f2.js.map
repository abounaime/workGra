{"version":3,"sources":["webpack:///51.200197dca04f05abe3f2.js","webpack:///./src/pages/StartPage.jsx"],"names":["webpackJsonp","1407","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_react","_react2","_reflux","_reflux2","_common","_Routes","_Routes2","_PermissionsMixin","_PermissionsMixin2","_StoreProvider","_StoreProvider2","_ActionsProvider","_ActionsProvider2","CurrentUserStore","getStore","GettingStartedStore","GettingStartedActions","getActions","StartPage","createClass","displayName","propTypes","history","PropTypes","object","isRequired","mixins","connect","listenTo","getInitialState","gettingStarted","undefined","componentDidMount","getStatus","reload","componentDidUpdate","this","_isLoading","_redirectToStartpage","onGettingStartedUpdate","state","setState","status","_redirect","page","props","pushState","isPermitted","currentUser","permissions","show","GETTING_STARTED","startpage","keys","length","type","stream_search","id","dashboard_show","isAnyPermitted","SEARCH","STREAMS","render","createElement","Spinner"],"mappings":"AAAAA,cAAc,KAERC,KACA,SAAUC,EAAQC,QAASC,GAEjC,YAiCA,SAASC,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GA9BvFG,OAAOC,eAAeP,QAAS,cAC7BQ,OAAO,GCTT,IAAAC,GAAAR,EAAA,GDcIS,EAAUR,EAAuBO,GCbrCE,EAAAV,EAAA,GDiBIW,EAAWV,EAAuBS,GCftCE,EAAAZ,EAAA,IACAa,EAAAb,EAAA,IDoBIc,EAAWb,EAAuBY,GClBtCE,EAAAf,EAAA,KDsBIgB,EAAqBf,EAAuBc,GCpBhDE,EAAAjB,EAAA,IDwBIkB,EAAkBjB,EAAuBgB,GCpB7CE,EAAAnB,EAAA,GDwBIoB,EAAoBnB,EAAuBkB,GC3BzCE,EAAmBH,EAAAd,QAAckB,SAAS,eAC1CC,EAAsBL,EAAAd,QAAckB,SAAS,kBAG7CE,EAAwBJ,EAAAhB,QAAgBqB,WAAW,kBAEnDC,EAAYjB,EAAAL,QAAMuB,aAAYC,YAAA,YAClCC,WACEC,QAASrB,EAAAL,QAAM2B,UAAUC,OAAOC,YAElCC,QAASvB,EAAAP,QAAO+B,QAAQd,GAAmBV,EAAAP,QAAOgC,SAASb,EAAqB,2BAChFc,gBALkC,WAMhC,OACEC,mBAAgBC,KAGpBC,kBAVkC,WAWhChB,EAAsBiB,YACtBpB,EAAiBqB,UAEnBC,mBAdkC,WAe3BC,KAAKC,cACRD,KAAKE,wBAGTC,uBAnBkC,SAmBXC,GACrBJ,KAAKK,UAAWX,eAAgBU,EAAME,UAExCC,UAtBkC,SAsBxBC,GACRR,KAAKS,MAAMvB,QAAQwB,UAAU,KAAMF,IAErCN,qBAzBkC,WA2BhC,GAAI9B,EAAAZ,QAAiBmD,YAAYX,KAAKI,MAAMQ,YAAYC,aAAc,mBAChEb,KAAKI,MAAMV,eAAeoB,KAE5B,WADAd,MAAKO,UAAUrC,EAAAV,QAAOuD,gBAM1B,IAAMC,GAAYhB,KAAKI,MAAMQ,YAAYI,SACzC,IAAkB,OAAdA,GAAsBvD,OAAOwD,KAAKD,GAAWE,OAAS,EAMxD,YALuB,WAAnBF,EAAUG,KACZnB,KAAKO,UAAUrC,EAAAV,QAAO4D,cAAcJ,EAAUK,KAE9CrB,KAAKO,UAAUrC,EAAAV,QAAO8D,eAAeN,EAAUK,KAM/CjD,GAAAZ,QAAiB+D,eAAevB,KAAKI,MAAMQ,YAAYC,aAAc,oBAAqB,mBAAoB,sBAChHb,KAAKO,UAAUrC,EAAAV,QAAOgE,QAEtBxB,KAAKO,UAAUrC,EAAAV,QAAOiE,UAG1BxB,WApDkC,WAqDhC,OAAQD,KAAKI,MAAMQ,cAAgBZ,KAAKI,MAAMV,gBAEhDgC,OAvDkC,WAwDhC,MAAO7D,GAAAL,QAAAmE,cAAA3D,EAAA4D,QAAA,QDoCXzE,SAAQK,QChCOsB,EDiCf5B,EAAOC,QAAUA,QAAiB","file":"51.200197dca04f05abe3f2.js","sourcesContent":["webpackJsonp([51],{\n\n/***/ 1407:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _react = __webpack_require__(2);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reflux = __webpack_require__(1);\n\nvar _reflux2 = _interopRequireDefault(_reflux);\n\nvar _common = __webpack_require__(48);\n\nvar _Routes = __webpack_require__(75);\n\nvar _Routes2 = _interopRequireDefault(_Routes);\n\nvar _PermissionsMixin = __webpack_require__(165);\n\nvar _PermissionsMixin2 = _interopRequireDefault(_PermissionsMixin);\n\nvar _StoreProvider = __webpack_require__(18);\n\nvar _StoreProvider2 = _interopRequireDefault(_StoreProvider);\n\nvar _ActionsProvider = __webpack_require__(7);\n\nvar _ActionsProvider2 = _interopRequireDefault(_ActionsProvider);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar CurrentUserStore = _StoreProvider2.default.getStore('CurrentUser');\nvar GettingStartedStore = _StoreProvider2.default.getStore('GettingStarted');\n\nvar GettingStartedActions = _ActionsProvider2.default.getActions('GettingStarted');\n\nvar StartPage = _react2.default.createClass({\n  displayName: 'StartPage',\n\n  propTypes: {\n    history: _react2.default.PropTypes.object.isRequired\n  },\n  mixins: [_reflux2.default.connect(CurrentUserStore), _reflux2.default.listenTo(GettingStartedStore, 'onGettingStartedUpdate')],\n  getInitialState: function getInitialState() {\n    return {\n      gettingStarted: undefined\n    };\n  },\n  componentDidMount: function componentDidMount() {\n    GettingStartedActions.getStatus();\n    CurrentUserStore.reload();\n  },\n  componentDidUpdate: function componentDidUpdate() {\n    if (!this._isLoading()) {\n      this._redirectToStartpage();\n    }\n  },\n  onGettingStartedUpdate: function onGettingStartedUpdate(state) {\n    this.setState({ gettingStarted: state.status });\n  },\n  _redirect: function _redirect(page) {\n    this.props.history.pushState(null, page);\n  },\n  _redirectToStartpage: function _redirectToStartpage() {\n    // Show getting started page if user is an admin and getting started wasn't dismissed\n    if (_PermissionsMixin2.default.isPermitted(this.state.currentUser.permissions, ['inputs:create'])) {\n      if (this.state.gettingStarted.show) {\n        this._redirect(_Routes2.default.GETTING_STARTED);\n        return;\n      }\n    }\n\n    // Show custom startpage if it was set\n    var startpage = this.state.currentUser.startpage;\n    if (startpage !== null && Object.keys(startpage).length > 0) {\n      if (startpage.type === 'stream') {\n        this._redirect(_Routes2.default.stream_search(startpage.id));\n      } else {\n        this._redirect(_Routes2.default.dashboard_show(startpage.id));\n      }\n      return;\n    }\n\n    // Show search page if permitted, or streams page in other case\n    if (_PermissionsMixin2.default.isAnyPermitted(this.state.currentUser.permissions, ['searches:absolute', 'searches:keyword', 'searches:relative'])) {\n      this._redirect(_Routes2.default.SEARCH);\n    } else {\n      this._redirect(_Routes2.default.STREAMS);\n    }\n  },\n  _isLoading: function _isLoading() {\n    return !this.state.currentUser || !this.state.gettingStarted;\n  },\n  render: function render() {\n    return _react2.default.createElement(_common.Spinner, null);\n  }\n});\n\nexports.default = StartPage;\nmodule.exports = exports['default'];\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// 51.200197dca04f05abe3f2.js","import React from 'react';\nimport Reflux from 'reflux';\n\nimport { Spinner } from 'components/common';\nimport Routes from 'routing/Routes';\n\nimport PermissionsMixin from 'util/PermissionsMixin';\n\nimport StoreProvider from 'injection/StoreProvider';\nconst CurrentUserStore = StoreProvider.getStore('CurrentUser');\nconst GettingStartedStore = StoreProvider.getStore('GettingStarted');\n\nimport ActionsProvider from 'injection/ActionsProvider';\nconst GettingStartedActions = ActionsProvider.getActions('GettingStarted');\n\nconst StartPage = React.createClass({\n  propTypes: {\n    history: React.PropTypes.object.isRequired,\n  },\n  mixins: [Reflux.connect(CurrentUserStore), Reflux.listenTo(GettingStartedStore, 'onGettingStartedUpdate')],\n  getInitialState() {\n    return {\n      gettingStarted: undefined,\n    };\n  },\n  componentDidMount() {\n    GettingStartedActions.getStatus();\n    CurrentUserStore.reload();\n  },\n  componentDidUpdate() {\n    if (!this._isLoading()) {\n      this._redirectToStartpage();\n    }\n  },\n  onGettingStartedUpdate(state) {\n    this.setState({ gettingStarted: state.status });\n  },\n  _redirect(page) {\n    this.props.history.pushState(null, page);\n  },\n  _redirectToStartpage() {\n    // Show getting started page if user is an admin and getting started wasn't dismissed\n    if (PermissionsMixin.isPermitted(this.state.currentUser.permissions, ['inputs:create'])) {\n      if (this.state.gettingStarted.show) {\n        this._redirect(Routes.GETTING_STARTED);\n        return;\n      }\n    }\n\n    // Show custom startpage if it was set\n    const startpage = this.state.currentUser.startpage;\n    if (startpage !== null && Object.keys(startpage).length > 0) {\n      if (startpage.type === 'stream') {\n        this._redirect(Routes.stream_search(startpage.id));\n      } else {\n        this._redirect(Routes.dashboard_show(startpage.id));\n      }\n      return;\n    }\n\n    // Show search page if permitted, or streams page in other case\n    if (PermissionsMixin.isAnyPermitted(this.state.currentUser.permissions, ['searches:absolute', 'searches:keyword', 'searches:relative'])) {\n      this._redirect(Routes.SEARCH);\n    } else {\n      this._redirect(Routes.STREAMS);\n    }\n  },\n  _isLoading() {\n    return !this.state.currentUser || !this.state.gettingStarted;\n  },\n  render() {\n    return <Spinner />;\n  },\n});\n\nexport default StartPage;\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/StartPage.jsx"],"sourceRoot":""}