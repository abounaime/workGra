{"version":3,"sources":["webpack:///43.200197dca04f05abe3f2.js","webpack:///./src/pages/ShowDashboardPage.jsx","webpack:///./src/pages/ShowDashboardPage.css","webpack:///./src/pages/ShowDashboardPage.css?0402"],"names":["webpackJsonp","1402","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_react","_react2","_reflux","_reflux2","_reactBootstrap","_plugin","_deepEqual","_deepEqual2","_StoreProvider","_StoreProvider2","_DocsHelper","_DocsHelper2","_UserNotification","_UserNotification2","_Routes","_Routes2","_common","_PermissionsMixin","_PermissionsMixin2","_DocumentationLink","_DocumentationLink2","_EditDashboardModalTrigger","_EditDashboardModalTrigger2","_Widget","_Widget2","_ShowDashboardPage","_ShowDashboardPage2","StreamsStore","getStore","CurrentUserStore","DashboardsStore","FocusStore","WidgetsStore","ShowDashboardPage","createClass","displayName","propTypes","history","PropTypes","object","isRequired","params","mixins","connect","getInitialState","locked","forceUpdateInBackground","streamIds","componentDidMount","_this","this","loadData","listenTo","removeWidget","load","streams","streamIds2","reduce","stream","id","setState","loadInterval","setInterval","state","currentUser","preferences","updateUnfocussed","componentWillUnmount","clearInterval","DASHBOARDS_EDIT","DEFAULT_HEIGHT","DEFAULT_WIDTH","_this2","dashboardId","props","get","then","dashboard","isMounted","widgets","sort","w1","w2","localeCompare","response","additional","status","error","pushState","DASHBOARDS","shouldUpdate","Boolean","focus","delete","emptyDashboard","createElement","Row","className","Col","md","Alert","page","PAGES","text","_defaultWidgetDimensions","widget","dimensions","col","row","widgetPlugin","PluginStore","filter","plugin","type","toUpperCase","height","defaultHeight","width","defaultWidth","_dashboardIsEmpty","length","_validDimension","dimension","Number","isInteger","formatDashboard","_this3","positions","forEach","persistedDimensions","defaultDimensions","undefined","widget1","widget2","position1","position2","map","key","widgetContainer","ReactGridContainer","onPositionsChange","_onPositionsChange","_unlockDashboard","event","preventDefault","_toggleUnlock","newPositions","updatePositions","_toggleFullscreen","element","document","documentElement","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","_toggleUpdateInBackground","forceUpdate","success","render","Spinner","actions","Button","bsStyle","onClick","IfPermitted","permissions","supportText","href","role","editDashboardTrigger","action","title","description","buttonClass","dashboardTitle","data-dashboard-id","DocumentTitle","PageHeader","1432","push","i","locals","1499","content"],"mappings":"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","file":"43.200197dca04f05abe3f2.js","sourcesContent":["webpackJsonp([43],{\n\n/***/ 1402:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _react = __webpack_require__(2);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reflux = __webpack_require__(1);\n\nvar _reflux2 = _interopRequireDefault(_reflux);\n\nvar _reactBootstrap = __webpack_require__(15);\n\nvar _plugin = __webpack_require__(258);\n\nvar _deepEqual = __webpack_require__(269);\n\nvar _deepEqual2 = _interopRequireDefault(_deepEqual);\n\nvar _StoreProvider = __webpack_require__(18);\n\nvar _StoreProvider2 = _interopRequireDefault(_StoreProvider);\n\nvar _DocsHelper = __webpack_require__(952);\n\nvar _DocsHelper2 = _interopRequireDefault(_DocsHelper);\n\nvar _UserNotification = __webpack_require__(5);\n\nvar _UserNotification2 = _interopRequireDefault(_UserNotification);\n\nvar _Routes = __webpack_require__(75);\n\nvar _Routes2 = _interopRequireDefault(_Routes);\n\nvar _common = __webpack_require__(48);\n\nvar _PermissionsMixin = __webpack_require__(165);\n\nvar _PermissionsMixin2 = _interopRequireDefault(_PermissionsMixin);\n\nvar _DocumentationLink = __webpack_require__(957);\n\nvar _DocumentationLink2 = _interopRequireDefault(_DocumentationLink);\n\nvar _EditDashboardModalTrigger = __webpack_require__(1055);\n\nvar _EditDashboardModalTrigger2 = _interopRequireDefault(_EditDashboardModalTrigger);\n\nvar _Widget = __webpack_require__(1206);\n\nvar _Widget2 = _interopRequireDefault(_Widget);\n\nvar _ShowDashboardPage = __webpack_require__(1499);\n\nvar _ShowDashboardPage2 = _interopRequireDefault(_ShowDashboardPage);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar StreamsStore = _StoreProvider2.default.getStore('Streams');\nvar CurrentUserStore = _StoreProvider2.default.getStore('CurrentUser');\nvar DashboardsStore = _StoreProvider2.default.getStore('Dashboards');\nvar FocusStore = _StoreProvider2.default.getStore('Focus');\nvar WidgetsStore = _StoreProvider2.default.getStore('Widgets');\n\nvar ShowDashboardPage = _react2.default.createClass({\n  displayName: 'ShowDashboardPage',\n\n  propTypes: {\n    history: _react2.default.PropTypes.object.isRequired,\n    params: _react2.default.PropTypes.object.isRequired\n  },\n  mixins: [_reflux2.default.connect(CurrentUserStore), _reflux2.default.connect(FocusStore), _PermissionsMixin2.default],\n\n  getInitialState: function getInitialState() {\n    return {\n      locked: true,\n      forceUpdateInBackground: false,\n      streamIds: null\n    };\n  },\n  componentDidMount: function componentDidMount() {\n    var _this = this;\n\n    this.loadData();\n    this.listenTo(WidgetsStore, this.removeWidget);\n    // we use the stream ids to potentially disable search replay buttons for deleted streams\n    StreamsStore.load(function (streams) {\n      var streamIds2 = streams.reduce(function (streamIds, stream) {\n        // eslint-disable-next-line no-param-reassign\n        streamIds[stream.id] = stream.id;\n        return streamIds;\n      }, {});\n      _this.setState({ streamIds: streamIds2 });\n    });\n    this.loadInterval = setInterval(this.loadData, 2000);\n    // eslint-disable-next-line react/no-did-mount-set-state\n    this.setState({ forceUpdateInBackground: this.state.currentUser.preferences.updateUnfocussed });\n  },\n  componentWillUnmount: function componentWillUnmount() {\n    if (this.loadInterval) {\n      clearInterval(this.loadInterval);\n    }\n  },\n\n  DASHBOARDS_EDIT: 'dashboards:edit',\n  DEFAULT_HEIGHT: 1,\n  DEFAULT_WIDTH: 2,\n  loadData: function loadData() {\n    var _this2 = this;\n\n    var dashboardId = this.props.params.dashboardId;\n    DashboardsStore.get(dashboardId).then(function (dashboard) {\n      if (!_this2.isMounted()) {\n        return;\n      }\n\n      // Compare dashboard in state with the one received, need to sort widgets to avoid that they come in\n      // a different order, affecting the comparison.\n      dashboard.widgets.sort(function (w1, w2) {\n        return w1.id.localeCompare(w2.id);\n      });\n      if (!_this2.state.dashboard || !(0, _deepEqual2.default)(_this2.state.dashboard, dashboard)) {\n        _this2.setState({ dashboard: dashboard });\n      }\n    }, function (response) {\n      if (response.additional && response.additional.status === 404) {\n        _UserNotification2.default.error('Unable to find a dashboard with the id <' + dashboardId + '>. Maybe it was deleted in the meantime.');\n        _this2.props.history.pushState(null, _Routes2.default.DASHBOARDS);\n      }\n    });\n  },\n  shouldUpdate: function shouldUpdate() {\n    return Boolean(this.state.forceUpdateInBackground || this.state.focus);\n  },\n  removeWidget: function removeWidget(props) {\n    if (props.delete) {\n      this.loadData();\n    }\n  },\n  emptyDashboard: function emptyDashboard() {\n    return _react2.default.createElement(\n      _reactBootstrap.Row,\n      { className: 'content' },\n      _react2.default.createElement(\n        _reactBootstrap.Col,\n        { md: 12 },\n        _react2.default.createElement(\n          _reactBootstrap.Alert,\n          { className: 'no-widgets' },\n          'This dashboard has no widgets yet. Learn how to add widgets in the ',\n          _react2.default.createElement(_DocumentationLink2.default, {\n            page: _DocsHelper2.default.PAGES.DASHBOARDS, text: 'documentation' }),\n          '.'\n        )\n      )\n    );\n  },\n  _defaultWidgetDimensions: function _defaultWidgetDimensions(widget) {\n    var dimensions = { col: 0, row: 0 };\n\n    var widgetPlugin = _plugin.PluginStore.exports('widgets').filter(function (plugin) {\n      return plugin.type.toUpperCase() === widget.type.toUpperCase();\n    })[0];\n    if (widgetPlugin) {\n      dimensions.height = widgetPlugin.defaultHeight;\n      dimensions.width = widgetPlugin.defaultWidth;\n    } else {\n      dimensions.height = this.DEFAULT_HEIGHT;\n      dimensions.width = this.DEFAULT_WIDTH;\n    }\n\n    return dimensions;\n  },\n  _dashboardIsEmpty: function _dashboardIsEmpty(dashboard) {\n    return dashboard.widgets.length === 0;\n  },\n  _validDimension: function _validDimension(dimension) {\n    return Number.isInteger(dimension) && dimension > 0;\n  },\n  formatDashboard: function formatDashboard(dashboard) {\n    var _this3 = this;\n\n    if (this._dashboardIsEmpty(dashboard)) {\n      return this.emptyDashboard();\n    }\n\n    var positions = {};\n    dashboard.widgets.forEach(function (widget) {\n      var persistedDimensions = dashboard.positions[widget.id] || {};\n      var defaultDimensions = _this3._defaultWidgetDimensions(widget);\n      positions[widget.id] = {\n        col: persistedDimensions.col === undefined ? defaultDimensions.col : persistedDimensions.col,\n        row: persistedDimensions.row === undefined ? defaultDimensions.row : persistedDimensions.row,\n        height: _this3._validDimension(persistedDimensions.height) ? persistedDimensions.height : defaultDimensions.height,\n        width: _this3._validDimension(persistedDimensions.width) ? persistedDimensions.width : defaultDimensions.width\n      };\n    });\n\n    var widgets = dashboard.widgets.sort(function (widget1, widget2) {\n      var position1 = positions[widget1.id];\n      var position2 = positions[widget2.id];\n      if (position1.col === position2.col) {\n        return position1.row - position2.row;\n      }\n\n      return position1.col - position2.col;\n    }).map(function (widget) {\n      return _react2.default.createElement(\n        'div',\n        { key: widget.id, className: _ShowDashboardPage2.default.widgetContainer },\n        _react2.default.createElement(_Widget2.default, { id: widget.id, key: 'widget-' + widget.id, widget: widget, dashboardId: dashboard.id,\n          locked: _this3.state.locked, shouldUpdate: _this3.shouldUpdate(), streamIds: _this3.state.streamIds })\n      );\n    });\n\n    return _react2.default.createElement(\n      _reactBootstrap.Row,\n      null,\n      _react2.default.createElement(\n        'div',\n        { className: 'dashboard' },\n        _react2.default.createElement(\n          _common.ReactGridContainer,\n          { positions: positions, onPositionsChange: this._onPositionsChange, locked: this.state.locked },\n          widgets\n        )\n      )\n    );\n  },\n  _unlockDashboard: function _unlockDashboard(event) {\n    event.preventDefault();\n    if (this.state.locked) {\n      this._toggleUnlock();\n    }\n  },\n  _toggleUnlock: function _toggleUnlock() {\n    this.setState({ locked: !this.state.locked });\n  },\n  _onPositionsChange: function _onPositionsChange(newPositions) {\n    DashboardsStore.updatePositions(this.state.dashboard, newPositions);\n  },\n  _toggleFullscreen: function _toggleFullscreen() {\n    var element = document.documentElement;\n    if (element.requestFullscreen) {\n      element.requestFullscreen();\n    } else if (element.mozRequestFullScreen) {\n      element.mozRequestFullScreen();\n    } else if (element.webkitRequestFullscreen) {\n      element.webkitRequestFullscreen();\n    } else if (element.msRequestFullscreen) {\n      element.msRequestFullscreen();\n    }\n  },\n  _toggleUpdateInBackground: function _toggleUpdateInBackground() {\n    var forceUpdate = !this.state.forceUpdateInBackground;\n    this.setState({ forceUpdateInBackground: forceUpdate });\n    _UserNotification2.default.success('Graphs will be updated ' + (forceUpdate ? 'even' : 'only') + ' when the browser is in the ' + (forceUpdate ? 'background' : 'foreground'), '');\n  },\n  render: function render() {\n    if (!this.state.dashboard) {\n      return _react2.default.createElement(_common.Spinner, null);\n    }\n\n    var dashboard = this.state.dashboard;\n\n    var actions = void 0;\n    if (!this._dashboardIsEmpty(dashboard)) {\n      actions = _react2.default.createElement(\n        'div',\n        null,\n        _react2.default.createElement(\n          _reactBootstrap.Button,\n          { id: 'update-unfocussed', bsStyle: 'info', onClick: this._toggleUpdateInBackground },\n          'Update in ',\n          this.state.forceUpdateInBackground ? 'foreground' : 'background'\n        ),\n        ' ',\n        _react2.default.createElement(\n          _reactBootstrap.Button,\n          { className: 'toggle-fullscreen', bsStyle: 'info', onClick: this._toggleFullscreen },\n          'Fullscreen'\n        ),\n        _react2.default.createElement(\n          _common.IfPermitted,\n          { permissions: this.DASHBOARDS_EDIT + ':' + dashboard.id },\n          ' ',\n          _react2.default.createElement(\n            _reactBootstrap.Button,\n            { bsStyle: 'success', onClick: this._toggleUnlock },\n            this.state.locked ? 'Unlock / Edit' : 'Lock'\n          )\n        )\n      );\n    }\n\n    var supportText = void 0;\n    if (!this._dashboardIsEmpty(dashboard)) {\n      supportText = _react2.default.createElement(\n        _common.IfPermitted,\n        { permissions: this.DASHBOARDS_EDIT + ':' + dashboard.id },\n        _react2.default.createElement(\n          'div',\n          { id: 'drag-widgets-description' },\n          'Drag widgets to any position you like in ',\n          _react2.default.createElement(\n            'a',\n            { href: '#', role: 'button', onClick: this._unlockDashboard },\n            'unlock / edit'\n          ),\n          ' mode.'\n        )\n      );\n    }\n\n    var editDashboardTrigger = !this.state.locked && !this._dashboardIsEmpty(dashboard) ? _react2.default.createElement(\n      _EditDashboardModalTrigger2.default,\n      { id: dashboard.id, action: 'edit', title: dashboard.title,\n        description: dashboard.description, buttonClass: 'btn-info btn-xs' },\n      _react2.default.createElement('i', { className: 'fa fa-pencil' })\n    ) : null;\n    var dashboardTitle = _react2.default.createElement(\n      'span',\n      null,\n      _react2.default.createElement(\n        'span',\n        { 'data-dashboard-id': dashboard.id, className: 'dashboard-title' },\n        dashboard.title\n      ),\n      '\\xA0',\n      editDashboardTrigger\n    );\n    return _react2.default.createElement(\n      _common.DocumentTitle,\n      { title: 'Dashboard ' + dashboard.title },\n      _react2.default.createElement(\n        'span',\n        null,\n        _react2.default.createElement(\n          _common.PageHeader,\n          { title: dashboardTitle },\n          _react2.default.createElement(\n            'span',\n            { 'data-dashboard-id': dashboard.id, className: 'dashboard-description' },\n            dashboard.description\n          ),\n          supportText,\n          actions\n        ),\n        this.formatDashboard(dashboard),\n        _react2.default.createElement('div', { className: 'clearfix' })\n      )\n    );\n  }\n});\n\nexports.default = ShowDashboardPage;\nmodule.exports = exports['default'];\n\n/***/ }),\n\n/***/ 1432:\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(19)();\n// imports\n\n\n// module\nexports.push([module.i, \"._3HrW10n1kzGWl5PDY4B2uD{background-color:#fff;border:1px solid #d1d1d1;z-index:auto}\", \"\"]);\n\n// exports\nexports.locals = {\n\t\"widgetContainer\": \"_3HrW10n1kzGWl5PDY4B2uD\"\n};\n\n/***/ }),\n\n/***/ 1499:\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(1432);\nif(typeof content === 'string') content = [[module.i, content, '']];\n// add the styles to the DOM\nvar update = __webpack_require__(20)(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(false) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!./ShowDashboardPage.css\", function() {\n\t\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!./ShowDashboardPage.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// 43.200197dca04f05abe3f2.js","import React from 'react';\nimport Reflux from 'reflux';\nimport { Row, Col, Button, Alert } from 'react-bootstrap';\nimport { PluginStore } from 'graylog-web-plugin/plugin';\nimport deepEqual from 'deep-equal';\n\nimport StoreProvider from 'injection/StoreProvider';\nconst StreamsStore = StoreProvider.getStore('Streams');\nconst CurrentUserStore = StoreProvider.getStore('CurrentUser');\nconst DashboardsStore = StoreProvider.getStore('Dashboards');\nconst FocusStore = StoreProvider.getStore('Focus');\nconst WidgetsStore = StoreProvider.getStore('Widgets');\n\nimport DocsHelper from 'util/DocsHelper';\nimport UserNotification from 'util/UserNotification';\nimport Routes from 'routing/Routes';\n\nimport { DocumentTitle, ReactGridContainer, PageHeader, Spinner, IfPermitted } from 'components/common';\nimport PermissionsMixin from 'util/PermissionsMixin';\nimport DocumentationLink from 'components/support/DocumentationLink';\nimport EditDashboardModalTrigger from 'components/dashboard/EditDashboardModalTrigger';\nimport Widget from 'components/widgets/Widget';\n\nimport style from './ShowDashboardPage.css';\n\nconst ShowDashboardPage = React.createClass({\n  propTypes: {\n    history: React.PropTypes.object.isRequired,\n    params: React.PropTypes.object.isRequired,\n  },\n  mixins: [Reflux.connect(CurrentUserStore), Reflux.connect(FocusStore), PermissionsMixin],\n\n  getInitialState() {\n    return {\n      locked: true,\n      forceUpdateInBackground: false,\n      streamIds: null,\n    };\n  },\n  componentDidMount() {\n    this.loadData();\n    this.listenTo(WidgetsStore, this.removeWidget);\n    // we use the stream ids to potentially disable search replay buttons for deleted streams\n    StreamsStore.load((streams) => {\n      const streamIds2 = streams.reduce((streamIds, stream) => {\n        // eslint-disable-next-line no-param-reassign\n        streamIds[stream.id] = stream.id;\n        return streamIds;\n      }, {});\n      this.setState({ streamIds: streamIds2 });\n    });\n    this.loadInterval = setInterval(this.loadData, 2000);\n    // eslint-disable-next-line react/no-did-mount-set-state\n    this.setState({ forceUpdateInBackground: this.state.currentUser.preferences.updateUnfocussed });\n  },\n  componentWillUnmount() {\n    if (this.loadInterval) {\n      clearInterval(this.loadInterval);\n    }\n  },\n  DASHBOARDS_EDIT: 'dashboards:edit',\n  DEFAULT_HEIGHT: 1,\n  DEFAULT_WIDTH: 2,\n  loadData() {\n    const dashboardId = this.props.params.dashboardId;\n    DashboardsStore.get(dashboardId)\n      .then((dashboard) => {\n        if (!this.isMounted()) {\n          return;\n        }\n\n        // Compare dashboard in state with the one received, need to sort widgets to avoid that they come in\n        // a different order, affecting the comparison.\n        dashboard.widgets.sort((w1, w2) => w1.id.localeCompare(w2.id));\n        if (!this.state.dashboard || !deepEqual(this.state.dashboard, dashboard)) {\n          this.setState({ dashboard: dashboard });\n        }\n      }, (response) => {\n        if (response.additional && response.additional.status === 404) {\n          UserNotification.error(`Unable to find a dashboard with the id <${dashboardId}>. Maybe it was deleted in the meantime.`);\n          this.props.history.pushState(null, Routes.DASHBOARDS);\n        }\n      });\n  },\n  shouldUpdate() {\n    return Boolean(this.state.forceUpdateInBackground || this.state.focus);\n  },\n  removeWidget(props) {\n    if (props.delete) {\n      this.loadData();\n    }\n  },\n  emptyDashboard() {\n    return (\n      <Row className=\"content\">\n        <Col md={12}>\n          <Alert className=\"no-widgets\">\n            This dashboard has no widgets yet. Learn how to add widgets in the <DocumentationLink\n            page={DocsHelper.PAGES.DASHBOARDS} text=\"documentation\" />.\n          </Alert>\n        </Col>\n      </Row>\n    );\n  },\n  _defaultWidgetDimensions(widget) {\n    const dimensions = { col: 0, row: 0 };\n\n    const widgetPlugin = PluginStore.exports('widgets').filter(plugin => plugin.type.toUpperCase() === widget.type.toUpperCase())[0];\n    if (widgetPlugin) {\n      dimensions.height = widgetPlugin.defaultHeight;\n      dimensions.width = widgetPlugin.defaultWidth;\n    } else {\n      dimensions.height = this.DEFAULT_HEIGHT;\n      dimensions.width = this.DEFAULT_WIDTH;\n    }\n\n    return dimensions;\n  },\n  _dashboardIsEmpty(dashboard) {\n    return dashboard.widgets.length === 0;\n  },\n  _validDimension(dimension) {\n    return Number.isInteger(dimension) && dimension > 0;\n  },\n  formatDashboard(dashboard) {\n    if (this._dashboardIsEmpty(dashboard)) {\n      return this.emptyDashboard();\n    }\n\n    const positions = {};\n    dashboard.widgets.forEach((widget) => {\n      const persistedDimensions = dashboard.positions[widget.id] || {};\n      const defaultDimensions = this._defaultWidgetDimensions(widget);\n      positions[widget.id] = {\n        col: (persistedDimensions.col === undefined ? defaultDimensions.col : persistedDimensions.col),\n        row: (persistedDimensions.row === undefined ? defaultDimensions.row : persistedDimensions.row),\n        height: (this._validDimension(persistedDimensions.height) ? persistedDimensions.height : defaultDimensions.height),\n        width: (this._validDimension(persistedDimensions.width) ? persistedDimensions.width : defaultDimensions.width),\n      };\n    });\n\n    const widgets = dashboard.widgets.sort((widget1, widget2) => {\n      const position1 = positions[widget1.id];\n      const position2 = positions[widget2.id];\n      if (position1.col === position2.col) {\n        return position1.row - position2.row;\n      }\n\n      return position1.col - position2.col;\n    }).map((widget) => {\n      return (\n        <div key={widget.id} className={style.widgetContainer}>\n          <Widget id={widget.id} key={`widget-${widget.id}`} widget={widget} dashboardId={dashboard.id}\n                  locked={this.state.locked} shouldUpdate={this.shouldUpdate()} streamIds={this.state.streamIds} />\n        </div>\n      );\n    });\n\n    return (\n      <Row>\n        <div className=\"dashboard\">\n          <ReactGridContainer positions={positions} onPositionsChange={this._onPositionsChange} locked={this.state.locked}>\n            {widgets}\n          </ReactGridContainer>\n        </div>\n      </Row>\n    );\n  },\n  _unlockDashboard(event) {\n    event.preventDefault();\n    if (this.state.locked) {\n      this._toggleUnlock();\n    }\n  },\n  _toggleUnlock() {\n    this.setState({ locked: !this.state.locked });\n  },\n  _onPositionsChange(newPositions) {\n    DashboardsStore.updatePositions(this.state.dashboard, newPositions);\n  },\n  _toggleFullscreen() {\n    const element = document.documentElement;\n    if (element.requestFullscreen) {\n      element.requestFullscreen();\n    } else if (element.mozRequestFullScreen) {\n      element.mozRequestFullScreen();\n    } else if (element.webkitRequestFullscreen) {\n      element.webkitRequestFullscreen();\n    } else if (element.msRequestFullscreen) {\n      element.msRequestFullscreen();\n    }\n  },\n  _toggleUpdateInBackground() {\n    const forceUpdate = !this.state.forceUpdateInBackground;\n    this.setState({ forceUpdateInBackground: forceUpdate });\n    UserNotification.success(`Graphs will be updated ${forceUpdate ? 'even' : 'only'} when the browser is in the ${forceUpdate ? 'background' : 'foreground'}`, '');\n  },\n  render() {\n    if (!this.state.dashboard) {\n      return <Spinner />;\n    }\n\n    const dashboard = this.state.dashboard;\n\n    let actions;\n    if (!this._dashboardIsEmpty(dashboard)) {\n      actions = (\n        <div>\n          <Button id=\"update-unfocussed\" bsStyle=\"info\" onClick={this._toggleUpdateInBackground}>\n            Update in {this.state.forceUpdateInBackground ? 'foreground' : 'background'}\n          </Button>\n          {' '}\n          <Button className=\"toggle-fullscreen\" bsStyle=\"info\" onClick={this._toggleFullscreen}>Fullscreen</Button>\n          <IfPermitted permissions={`${this.DASHBOARDS_EDIT}:${dashboard.id}`}>\n            {' '}\n            <Button bsStyle=\"success\" onClick={this._toggleUnlock}>{this.state.locked ? 'Unlock / Edit' : 'Lock'}</Button>\n          </IfPermitted>\n        </div>\n      );\n    }\n\n    let supportText;\n    if (!this._dashboardIsEmpty(dashboard)) {\n      supportText = (\n        <IfPermitted permissions={`${this.DASHBOARDS_EDIT}:${dashboard.id}`}>\n          <div id=\"drag-widgets-description\">\n            Drag widgets to any position you like in <a href=\"#\" role=\"button\" onClick={this._unlockDashboard}>\n            unlock / edit</a> mode.\n          </div>\n        </IfPermitted>\n      );\n    }\n\n    const editDashboardTrigger = !this.state.locked && !this._dashboardIsEmpty(dashboard) ?\n      (<EditDashboardModalTrigger id={dashboard.id} action=\"edit\" title={dashboard.title}\n                                 description={dashboard.description} buttonClass=\"btn-info btn-xs\">\n        <i className=\"fa fa-pencil\" />\n      </EditDashboardModalTrigger>) : null;\n    const dashboardTitle = (\n      <span>\n        <span data-dashboard-id={dashboard.id} className=\"dashboard-title\">{dashboard.title}</span>\n        &nbsp;\n        {editDashboardTrigger}\n      </span>\n    );\n    return (\n      <DocumentTitle title={`Dashboard ${dashboard.title}`}>\n        <span>\n          <PageHeader title={dashboardTitle}>\n            <span data-dashboard-id={dashboard.id} className=\"dashboard-description\">{dashboard.description}</span>\n            {supportText}\n            {actions}\n          </PageHeader>\n\n          {this.formatDashboard(dashboard)}\n          <div className=\"clearfix\" />\n        </span>\n      </DocumentTitle>\n    );\n  },\n});\n\nexport default ShowDashboardPage;\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/ShowDashboardPage.jsx","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \"._3HrW10n1kzGWl5PDY4B2uD{background-color:#fff;border:1px solid #d1d1d1;z-index:auto}\", \"\"]);\n\n// exports\nexports.locals = {\n\t\"widgetContainer\": \"_3HrW10n1kzGWl5PDY4B2uD\"\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader!./src/pages/ShowDashboardPage.css\n// module id = 1432\n// module chunks = 43","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/index.js!./ShowDashboardPage.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!../../node_modules/style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!./ShowDashboardPage.css\", function() {\n\t\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!./ShowDashboardPage.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/ShowDashboardPage.css\n// module id = 1499\n// module chunks = 43"],"sourceRoot":""}