webpackJsonp([39],{1323:function(e,exports,t){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),a=l(s),o=t(55),i=l(o),n=t(15),r=t(43),d=t(1326),u=l(d),c=t(165),f=l(c),m=a.default.createClass({displayName:"EditRole",propTypes:{initialRole:a.default.PropTypes.object,onSave:a.default.PropTypes.func.isRequired,cancelEdit:a.default.PropTypes.func.isRequired,streams:a.default.PropTypes.object,dashboards:a.default.PropTypes.object},mixins:[f.default],getInitialState:function(){var e=this.props.initialRole;return null===e&&(e={name:null,description:null,permissions:[]}),{role:e,initialName:this._safeRoleName(this.props.initialRole)}},componentWillReceiveProps:function(e){this.setState({role:e.initialRole,initialName:this._safeRoleName(e.initialRole)})},_safeRoleName:function(e){return null===e?null:e.name},_setName:function(e){this.state.role.name=e.target.value,this.setState({role:this.state.role})},_setDescription:function(e){this.state.role.description=e.target.value,this.setState({role:this.state.role})},_updatePermissions:function(e,t){var l=this.state.role;l.permissions=i.default.Set(l.permissions).subtract(t).union(e).toJS(),this.setState({role:l})},_saveDisabled:function(){return null===this.state.role||null===this.state.role.name||""===this.state.role.name||0===this.state.role.permissions.length},_onSave:function(){this.props.onSave(this.state.initialName,this.state.role)},render:function(){var e=void 0;e=null===this.state.initialName?"Create a new role":"Edit role "+this.state.initialName;var t=this._saveDisabled(),l=null;return t&&(l=a.default.createElement(n.Alert,{bsStyle:"warning",style:{marginBottom:10}},"Please name the role and select at least one permission to save it.")),a.default.createElement(n.Row,null,a.default.createElement(n.Col,{md:12},a.default.createElement("h1",null,e),a.default.createElement("div",{style:{marginTop:10}},a.default.createElement(r.Input,{id:"role-name",type:"text",label:"Name",onChange:this._setName,value:this.state.role.name,required:!0}),a.default.createElement(r.Input,{id:"role-description",type:"text",label:"Description",onChange:this._setDescription,value:this.state.role.description}),a.default.createElement(n.FormGroup,null,a.default.createElement(n.ControlLabel,null,"Permissions"),a.default.createElement(n.HelpBlock,null,"Select the permissions for this role")),a.default.createElement(u.default,{streams:this.props.streams,dashboards:this.props.dashboards,permissions:i.default.Set(this.state.role.permissions),onChange:this._updatePermissions}),a.default.createElement("hr",null),l,a.default.createElement(n.Button,{onClick:this._onSave,style:{marginRight:5},bsStyle:"primary",disabled:t},"Save"),a.default.createElement(n.Button,{onClick:this.props.cancelEdit},"Cancel"))))}});exports.default=m,e.exports=exports.default},1326:function(e,exports,t){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),a=l(s),o=t(55),i=l(o),n=t(15),r=t(48),d=a.default.createClass({displayName:"PermissionSelector",propTypes:{onChange:a.default.PropTypes.func,streams:a.default.PropTypes.object,dashboards:a.default.PropTypes.object,permissions:a.default.PropTypes.object},render:function(){var e=this,t=function(t){var l=e.props.permissions.contains("streams:read:"+t.id),s=e.props.permissions.contains("streams:edit:"+t.id);return a.default.createElement(n.ButtonGroup,{bsSize:"small"},a.default.createElement(n.Button,{bsStyle:l?"info":"default",onClick:function(){return e._toggleStreamReadPermissions(t)},active:l},"Allow reading"),a.default.createElement(n.Button,{bsStyle:s?"info":"default",onClick:function(){return e._toggleStreamEditPermissions(t)},active:s},"Allow editing"))},l=function(t){return a.default.createElement("div",{className:"pull-right",style:{marginTop:10,marginBottom:10}},a.default.createElement(n.Button,{bsSize:"xsmall",bsStyle:"info",onClick:function(){return e._toggleAllStreamsRead(t)}},"Toggle read permissions")," ",a.default.createElement(n.Button,{bsSize:"xsmall",bsStyle:"info",onClick:function(){return e._toggleAllStreamsEdit(t)}},"Toggle edit permissions"))},s=function(t){var l=e.props.permissions.contains("dashboards:read:"+t.id),s=e.props.permissions.contains("dashboards:edit:"+t.id);return a.default.createElement(n.ButtonGroup,{bsSize:"small"},a.default.createElement(n.Button,{bsStyle:l?"info":"default",onClick:function(){return e._toggleDashboardReadPermissions(t)},active:l},"Allow reading"),a.default.createElement(n.Button,{bsStyle:s?"info":"default",onClick:function(){return e._toggleDashboardEditPermissions(t)},active:s},"Allow editing"))},o=function(t){return a.default.createElement("div",{className:"pull-right",style:{marginTop:10,marginBottom:10}},a.default.createElement(n.Button,{bsSize:"xsmall",bsStyle:"info",onClick:function(){return e._toggleAllDashboardsRead(t)}},"Toggle read permissions")," ",a.default.createElement(n.Button,{bsSize:"xsmall",bsStyle:"info",onClick:function(){return e._toggleAllDashboardsEdit(t)}},"Toggle edit permissions"))};return a.default.createElement("div",null,a.default.createElement(n.Tabs,{id:"permissionSelectorTabs",defaultActiveKey:1,animation:!1},a.default.createElement(n.Tab,{eventKey:1,title:"Streams"},a.default.createElement("div",{style:{marginTop:10}},a.default.createElement(r.TableList,{items:this.props.streams,filterLabel:"Filter Streams",filterKeys:["title"],itemActionsFactory:t,headerActionsFactory:l}))),a.default.createElement(n.Tab,{eventKey:2,title:"Dashboards"},a.default.createElement("div",{style:{marginTop:10}},a.default.createElement(r.TableList,{items:this.props.dashboards,filterLabel:"Filter Dashboards",filterKeys:["title"],itemActionsFactory:s,headerActionsFactory:o})))))},_toggleStreamReadPermissions:function(e){this._toggleReadPermissions("streams",i.default.Set.of(e.id))},_toggleStreamEditPermissions:function(e){this._toggleEditPermissions("streams",i.default.Set.of(e.id))},_toggleDashboardReadPermissions:function(e){this._toggleReadPermissions("dashboards",i.default.Set.of(e.id))},_toggleDashboardEditPermissions:function(e){this._toggleEditPermissions("dashboards",i.default.Set.of(e.id))},_toggleAllStreamsRead:function(e){this._toggleReadPermissions("streams",e)},_toggleAllStreamsEdit:function(e){this._toggleEditPermissions("streams",e)},_toggleAllDashboardsRead:function(e){this._toggleReadPermissions("dashboards",e)},_toggleAllDashboardsEdit:function(e){this._toggleEditPermissions("dashboards",e)},_toggleReadPermissions:function(e,t){var l=this,s=i.default.Set.of(),a=i.default.Set.of();t.forEach(function(t){var o=e+":read:"+t,i=e+":edit:"+t;l.props.permissions.contains(o)?a=a.add(o).add(i):s=s.add(o)},this),this.props.onChange(s,a)},_toggleEditPermissions:function(e,t){var l=this,s=i.default.Set.of(),a=i.default.Set.of();t.forEach(function(t){var o=e+":read:"+t,i=e+":edit:"+t;l.props.permissions.contains(i)?a=a.add(i):s=s.add(o).add(i)},this),this.props.onChange(s,a)}});exports.default=d,e.exports=exports.default},1327:function(e,exports,t){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),a=l(s),o=t(55),i=l(o),n=t(15),r=t(48),d=a.default.createClass({displayName:"RoleList",propTypes:{roles:a.default.PropTypes.instanceOf(i.default.Set).isRequired,showEditRole:a.default.PropTypes.func.isRequired,deleteRole:a.default.PropTypes.func.isRequired},_headerCellFormatter:function(e){var t="Actions"===e?"actions":"";return a.default.createElement("th",{className:t},e)},_roleInfoFormatter:function(e){var t=this,l=[a.default.createElement(n.Button,{key:"delete",bsSize:"xsmall",bsStyle:"primary",onClick:function(){return t.props.deleteRole(e)},title:"Delete role"},"Delete"),a.default.createElement("span",{key:"space"}," "),a.default.createElement(n.Button,{key:"edit",bsSize:"xsmall",bsStyle:"info",onClick:function(){return t.props.showEditRole(e)},title:"Edit role"},"Edit")];return a.default.createElement("tr",{key:e.name},a.default.createElement("td",null,e.name),a.default.createElement("td",{className:"limited"},e.description),a.default.createElement("td",null,e.read_only?null:l))},render:function(){var e=["name","description"],t=["Name","Description","Actions"];return a.default.createElement("div",null,a.default.createElement(r.DataTable,{id:"role-list",className:"table-hover",headers:t,headerCellFormatter:this._headerCellFormatter,sortByKey:"name",rows:this.props.roles.toJS(),filterBy:"Name",dataRowFormatter:this._roleInfoFormatter,filterLabel:"Filter Roles",filterKeys:e}))}});exports.default=d,e.exports=exports.default},1328:function(e,exports,t){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),a=l(s),o=t(55),i=l(o),n=t(15),r=t(18),d=l(r),u=t(5),c=l(u),f=t(1327),m=l(f),h=t(1323),p=l(h),g=t(265),E=l(g),b=d.default.getStore("Streams"),R=d.default.getStore("Dashboards"),_=d.default.getStore("Roles"),S=a.default.createClass({displayName:"RolesComponent",getInitialState:function(){return{roles:i.default.Set(),rolesLoaded:!1,editRole:null,streams:i.default.List(),dashboards:i.default.List()}},componentDidMount:function(){var e=this;this.loadRoles(),b.load(function(t){return e.setState({streams:i.default.List(t)})}),R.listDashboards().then(function(t){return e.setState({dashboards:t})})},loadRoles:function(){var e=this;_.loadRoles().then(function(t){e.setState({roles:i.default.Set(t),rolesLoaded:!0})})},_showCreateRole:function(){this.setState({showEditRole:!0})},_showEditRole:function(e){this.setState({showEditRole:!0,editRole:e})},_deleteRole:function(e){var t=this;window.confirm("Do you really want to delete role "+e.name+"?")&&_.getMembers(e.name).then(function(l){0!==l.users.length?c.default.error("Cannot delete role "+e.name+". It is still assigned to "+l.users.length+" users."):_.deleteRole(e.name).then(t.loadRoles)})},_saveRole:function(e,t){null===e?_.createRole(t).then(this._clearEditRole).then(this.loadRoles):_.updateRole(e,t).then(this._clearEditRole).then(this.loadRoles)},_clearEditRole:function(){this.setState({showEditRole:!1,editRole:null})},render:function(){var e=null;e=this.state.rolesLoaded?this.state.showEditRole?a.default.createElement(p.default,{initialRole:this.state.editRole,streams:this.state.streams,dashboards:this.state.dashboards,onSave:this._saveRole,cancelEdit:this._clearEditRole}):a.default.createElement(m.default,{roles:this.state.roles,showEditRole:this._showEditRole,deleteRole:this._deleteRole}):a.default.createElement("span",null,"Loading roles...");var t=void 0;return this.state.showEditRole||(t=a.default.createElement(n.Button,{bsStyle:"success",onClick:this._showCreateRole},"Add new role")),a.default.createElement(n.Row,null,a.default.createElement(n.Col,{md:12},a.default.createElement(E.default,{title:"Roles",subpage:!0},a.default.createElement("span",null,"Roles bundle permissions which can be assigned to multiple users at once"),null,a.default.createElement("span",null,t)),e))}});exports.default=S,e.exports=exports.default},1399:function(e,exports,t){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),a=l(s),o=t(15),i=t(1328),n=l(i),r=t(48),d=a.default.createClass({displayName:"RolesPage",render:function(){return a.default.createElement(r.DocumentTitle,{title:"Roles"},a.default.createElement(o.Row,null,a.default.createElement(o.Col,{md:12},a.default.createElement(n.default,null))))}});exports.default=d,e.exports=exports.default}});
//# sourceMappingURL=39.200197dca04f05abe3f2.js.map