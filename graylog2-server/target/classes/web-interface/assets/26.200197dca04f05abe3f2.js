webpackJsonp([26],{1019:function(e,exports,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),n=a(s),r=t(961),l=a(r),i=t(15),o=t(43),u=t(260),d=a(u),c=n.default.createClass({displayName:"InputDropdown",propTypes:{inputs:s.PropTypes.object,title:s.PropTypes.string,preselectedInputId:s.PropTypes.string,onLoadMessage:s.PropTypes.func,disabled:s.PropTypes.bool},mixins:[l.default],getInitialState:function(){return{selectedInput:this.props.preselectedInputId||this.PLACEHOLDER}},PLACEHOLDER:"placeholder",_formatInput:function(e){return n.default.createElement("option",{key:e.id,value:e.id},e.title," (",e.type,")")},_sortByTitle:function(e,t){return e.title.localeCompare(t.title)},_onLoadMessage:function(){this.props.onLoadMessage(this.state.selectedInput)},_formatStaticInput:function(e){return n.default.createElement(o.Input,{type:"select",style:{float:"left",width:400,marginRight:10},disabled:!0},n.default.createElement("option",null,e.title+" ("+e.type+")"))},render:function(){if(this.props.inputs&&this.props.preselectedInputId)return n.default.createElement("div",null,this._formatStaticInput(this.props.inputs.get(this.props.preselectedInputId)),n.default.createElement(i.Button,{bsStyle:"info",disabled:this.state.selectedInput===this.PLACEHOLDER,onClick:this._onLoadMessage},this.props.title));if(this.props.inputs){var e=this.props.inputs.sort(this._sortByTitle).map(this._formatInput);return n.default.createElement("div",null,n.default.createElement(o.Input,{type:"select",style:{float:"left",width:400,marginRight:10},valueLink:this.linkState("selectedInput"),placeholder:this.PLACEHOLDER},n.default.createElement("option",{value:this.PLACEHOLDER},"Select an input"),e.toArray()),n.default.createElement(i.Button,{bsStyle:"info",disabled:this.props.disabled||this.state.selectedInput===this.PLACEHOLDER,onClick:this._onLoadMessage},this.props.title))}return n.default.createElement(d.default,null)}});exports.default=c,e.exports=exports.default},1095:function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var a=t(2),s=function(e){return e&&e.__esModule?e:{default:e}}(a),n=s.default.createClass({displayName:"HumanReadableStreamRule",propTypes:{streamRule:s.default.PropTypes.object.isRequired,streamRuleTypes:s.default.PropTypes.array.isRequired},EMPTY_TAG:"<empty>",FIELD_PRESENCE_RULE_TYPE:5,ALWAYS_MATCH_RULE_TYPE:7,_getTypeForInteger:function(e,t){if(t)return t.filter(function(t){return String(t.id)===String(e)})[0]},_formatRuleValue:function(e){return String(e.type)!==String(this.FIELD_PRESENCE_RULE_TYPE)?e.value?e.value:this.EMPTY_TAG:null},_formatRuleField:function(e){return e.field?e.field:this.EMPTY_TAG},render:function(){var e=this.props.streamRule,t=this._getTypeForInteger(e.type,this.props.streamRuleTypes),a=e.inverted?"not ":null,n=t?t.long_desc:null;return String(e.type)===String(this.ALWAYS_MATCH_RULE_TYPE)?s.default.createElement("span",null,"Rule always matches"):s.default.createElement("span",null,"Field ",s.default.createElement("em",null,this._formatRuleField(e))," must ",a,n," ",s.default.createElement("em",null,this._formatRuleValue(e)))}});exports.default=n,e.exports=exports.default},1096:function(e,exports,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),n=a(s),r=t(15),l=t(961),i=a(l),o=t(43),u=t(261),d=a(u),c=t(48),p=t(960),m=t(952),f=a(m),h=t(1098),g=a(h),y=t(1095),E=a(y),b=n.default.createClass({displayName:"StreamRuleForm",propTypes:{onSubmit:n.default.PropTypes.func.isRequired,streamRule:n.default.PropTypes.object,streamRuleTypes:n.default.PropTypes.array.isRequired,title:n.default.PropTypes.string.isRequired},mixins:[i.default],getDefaultProps:function(){return{streamRule:{field:"",type:1,value:"",inverted:!1,description:""}}},getInitialState:function(){return this.props.streamRule},FIELD_PRESENCE_RULE_TYPE:5,ALWAYS_MATCH_RULE_TYPE:7,_resetValues:function(){this.setState(this.props.streamRule)},_onSubmit:function(){this.state.type===this.ALWAYS_MATCH_RULE_TYPE&&(this.state.field=""),this.state.type!==this.FIELD_PRESENCE_RULE_TYPE&&this.state.type!==this.ALWAYS_MATCH_RULE_TYPE||(this.state.value=""),this.props.onSubmit(this.props.streamRule.id,this.state),this.refs.modal.close()},_formatStreamRuleType:function(e){return n.default.createElement("option",{key:"streamRuleType"+e.id,value:e.id},e.short_desc)},open:function(){this._resetValues(),this.refs.modal.open()},close:function(){this.refs.modal.close()},render:function(){var e=this.props.streamRuleTypes.map(this._formatStreamRuleType),t=String(this.state.type)!==String(this.ALWAYS_MATCH_RULE_TYPE)?n.default.createElement(c.TypeAheadFieldInput,{ref:"fieldInput",type:"text",required:!0,label:"Field",valueLink:this.linkState("field"),autoFocus:!0}):"",a=String(this.state.type)!==String(this.FIELD_PRESENCE_RULE_TYPE)&&String(this.state.type)!==String(this.ALWAYS_MATCH_RULE_TYPE)?n.default.createElement(o.Input,{id:"Value",type:"text",required:!0,label:"Value",name:"Value",valueLink:this.linkState("value")}):"";return n.default.createElement(d.default,{ref:"modal",title:this.props.title,onSubmitForm:this._onSubmit,submitButtonText:"Save",formProps:{id:"StreamRuleForm"}},n.default.createElement("div",null,n.default.createElement(r.Col,{md:8},t,n.default.createElement(o.Input,{id:"Type",type:"select",required:!0,label:"Type",name:"Type",valueLink:this.linkState("type")},e),a,n.default.createElement(o.Input,{id:"Inverted",type:"checkbox",label:"Inverted",name:"Inverted",checkedLink:this.linkState("inverted")}),n.default.createElement(o.Input,{id:"Description",type:"textarea",label:"Description (optional)",name:"Description",valueLink:this.linkState("description")}),n.default.createElement("p",null,n.default.createElement("strong",null,"Result:")," ",n.default.createElement(E.default,{streamRule:this.state,streamRuleTypes:this.props.streamRuleTypes}))),n.default.createElement(r.Col,{md:4},n.default.createElement("div",{className:"well well-sm matcher-github"},"The server will try to convert to strings or numbers based on the matcher type as good as it can.",n.default.createElement("br",null),n.default.createElement("br",null),n.default.createElement("i",{className:"fa fa-github"}),n.default.createElement("a",{href:"https://github.com/Graylog2/graylog2-server/tree/"+g.default.getMajorAndMinorVersion()+"/graylog2-server/src/main/java/org/graylog2/streams/matchers",target:"_blank"}," Take a look at the matcher code on GitHub"),n.default.createElement("br",null),n.default.createElement("br",null),"Regular expressions use Java syntax. ",n.default.createElement(p.DocumentationLink,{page:f.default.PAGES.STREAMS,title:"More information",text:n.default.createElement("i",{className:"fa fa-lightbulb-o"})})))))}});exports.default=b,e.exports=exports.default},1148:function(e,exports,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),n=a(s),r=t(1),l=a(r),i=t(15),o=t(55),u=a(o),d=t(18),c=a(d),p=t(7),m=a(p),f=t(1103),h=a(f),g=t(989),y=a(g),E=t(1149),b=a(E),_=t(1150),T=a(_),v=c.default.getStore("Inputs"),S=c.default.getStore("Streams"),R=m.default.getActions("Inputs"),I=n.default.createClass({displayName:"LoaderTabs",propTypes:{tabs:n.default.PropTypes.oneOfType([n.default.PropTypes.oneOf(["recent","messageId","raw"]),n.default.PropTypes.arrayOf(n.default.PropTypes.oneOf(["recent","messageId","raw"]))]),messageId:s.PropTypes.string,index:s.PropTypes.string,onMessageLoaded:s.PropTypes.func,selectedInputId:s.PropTypes.string,customFieldActions:s.PropTypes.node,disableMessagePreview:s.PropTypes.bool},mixins:[l.default.listenTo(v,"_formatInputs")],getDefaultProps:function(){return{tabs:["recent","messageId"]}},getInitialState:function(){return{activeTab:void 0,message:void 0,inputs:void 0}},componentDidMount:function(){this.loadData(),this.props.messageId&&this.props.index&&this.refs.messageLoader.submit(this.props.messageId,this.props.index)},onMessageLoaded:function(e){this.setState({message:e}),this.props.onMessageLoaded&&this.props.onMessageLoaded(e)},TAB_KEYS:{recent:1,messageId:2,raw:3},_formatInputs:function(e){var t=v.inputsAsMap(e.inputs);this.setState({inputs:u.default.Map(t)})},loadData:function(){var e=this;R.list(),S.listStreams().then(function(t){var a={};t.forEach(function(e){a[e.id]=e}),e.setState({streams:u.default.Map(a)})})},_isTabVisible:function(e){return this.props.tabs===e||-1!==this.props.tabs.indexOf(e)},_getActiveTab:function(){return this.state.activeTab?this.state.activeTab:this._isTabVisible("messageId")&&this.props.messageId&&this.props.index?this.TAB_KEYS.messageId:this._isTabVisible("recent")?this.TAB_KEYS.recent:this._isTabVisible("messageId")?this.TAB_KEYS.messageId:this.TAB_KEYS.raw},_changeActiveTab:function(e){this.state.activeTab!==e&&this.setState({activeTab:e,message:void 0})},_formatMessageLoaders:function(){var e=[];return this._isTabVisible("recent")&&e.push(n.default.createElement(i.Tab,{key:"recent",eventKey:this.TAB_KEYS.recent,title:"Recent Message",style:{marginBottom:10}},n.default.createElement(T.default,{inputs:this.state.inputs,selectedInputId:this.props.selectedInputId,onMessageLoaded:this.onMessageLoaded}))),this._isTabVisible("messageId")&&e.push(n.default.createElement(i.Tab,{key:"messageId",eventKey:this.TAB_KEYS.messageId,title:"Message ID",style:{marginBottom:10}},n.default.createElement("div",{style:{marginTop:5,marginBottom:15}},"Please provide the id and index of the message that you want to load in this form:"),n.default.createElement(y.default,{ref:"messageLoader",onMessageLoaded:this.onMessageLoaded,hidden:!1,hideText:!0}))),this._isTabVisible("raw")&&e.push(n.default.createElement(i.Tab,{key:"raw",eventKey:this.TAB_KEYS.raw,title:"Raw Message",style:{marginBottom:10}},n.default.createElement("div",{style:{marginTop:5,marginBottom:15}},"Load a message from text, as if it was sent by a log source."),n.default.createElement(b.default,{onMessageLoaded:this.onMessageLoaded}))),e},render:function(){var e=void 0;return this.state.message&&this.state.inputs&&!this.props.disableMessagePreview&&(e=n.default.createElement(i.Col,{md:12},n.default.createElement(h.default,{message:this.state.message,inputs:this.state.inputs,streams:this.state.streams,disableTestAgainstStream:!0,disableSurroundingSearch:!0,disableFieldActions:!this.props.customFieldActions,customFieldActions:this.props.customFieldActions}))),n.default.createElement("div",null,n.default.createElement(i.Tabs,{id:"loaderTabs",activeKey:this._getActiveTab(),onSelect:this._changeActiveTab,animation:!1},this._formatMessageLoaders()),e)}});exports.default=I,e.exports=exports.default},1149:function(e,exports,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),n=a(s),r=t(1),l=a(r),i=t(15),o=t(43),u=t(48),d=t(953),c=t(7),p=a(c),m=t(18),f=a(m),h=p.default.getActions("Messages"),g=p.default.getActions("CodecTypes"),y=p.default.getActions("Inputs"),E=(f.default.getStore("Messages"),f.default.getStore("CodecTypes")),b=f.default.getStore("Inputs"),_=n.default.createClass({displayName:"RawMessageLoader",propTypes:{onMessageLoaded:n.default.PropTypes.func.isRequired,inputIdSelector:n.default.PropTypes.bool},mixins:[l.default.connect(E),l.default.connect(b)],getDefaultProps:function(){return{inputIdSelector:!1}},getInitialState:function(){return{loading:!1,message:"",remoteAddress:"",codec:"",codecConfiguration:{},inputId:void 0}},componentDidMount:function(){g.list(),this.props.inputIdSelector&&y.list()},DEFAULT_REMOTE_ADDRESS:"127.0.0.1",_loadMessage:function(e){var t=this;e.preventDefault();var a=this.state,s=a.message,n=a.remoteAddress,r=a.codec,l=a.codecConfiguration,i=a.inputId;this.setState({loading:!0});var o=h.loadRawMessage.triggerPromise(s,n||this.DEFAULT_REMOTE_ADDRESS,r,l);o.then(function(e){t.props.onMessageLoaded(e,{message:s,remoteAddress:n,codec:r,codecConfiguration:l,inputId:i})}),o.finally(function(){return t.setState({loading:!1})})},_bindValue:function(e){var t={};t[e.target.name]=e.target.value,this.setState(t)},_formatSelectOptions:function(){var e=this;if(!this.state.codecTypes)return[{value:"none",label:"Loading codec types...",disabled:!0}];var t=Object.keys(this.state.codecTypes);return 0===t.length?[{value:"none",label:"No codecs available"}]:t.filter(function(e){return"random-http-msg"!==e}).map(function(t){var a=e.state.codecTypes[t].name;return{value:t,label:""===a?t:a}}).sort(function(e,t){return e.label.toLowerCase().localeCompare(t.label.toLowerCase())})},_formatInputSelectOptions:function(){var e=this;if(!this.state.inputs)return[{value:"none",label:"Loading inputs...",disabled:!0}];var t=Object.keys(this.state.inputs);return 0===t.length?[{value:"none",label:"No inputs available"}]:t.map(function(t){var a=e.state.inputs[t].id;return{value:a,label:a+" / "+e.state.inputs[t].title+" / "+e.state.inputs[t].name}}).sort(function(e,t){return e.label.toLowerCase().localeCompare(t.label.toLowerCase())})},_onCodecSelect:function(e){this._bindValue({target:{name:"codec",value:e}}),this.setState({codecConfiguration:{}})},_onInputSelect:function(e){this.setState({inputId:e})},_onCodecConfigurationChange:function(e,t){var a=Object.assign(this.state.codecConfiguration);a[e]=t,this._bindValue({target:{name:"codecConfiguration",value:a}})},_formatConfigField:function(e,t){var a=this.state.codecConfiguration[e],s="RawMessageLoader",r=s+"-"+e;switch(t.type){case"text":return n.default.createElement(d.TextField,{key:r,typeName:s,title:e,field:t,value:a,onChange:this._onCodecConfigurationChange});case"number":return n.default.createElement(d.NumberField,{key:r,typeName:s,title:e,field:t,value:a,onChange:this._onCodecConfigurationChange});case"boolean":return n.default.createElement(d.BooleanField,{key:r,typeName:s,title:e,field:t,value:a,onChange:this._onCodecConfigurationChange});case"dropdown":return n.default.createElement(d.DropdownField,{key:r,typeName:s,title:e,field:t,value:a,onChange:this._onCodecConfigurationChange});default:return null}},_isSubmitDisabled:function(){return!this.state.message||!this.state.codec||this.state.loading},render:function(){var e=this,t=void 0;if(this.state.codecTypes&&this.state.codec){var a=this.state.codecTypes[this.state.codec].requested_configuration;t=Object.keys(a).sort(function(e,t){return a[e].is_optional-a[t].is_optional}).map(function(t){return e._formatConfigField(t,a[t])})}var s=void 0;return this.props.inputIdSelector&&(s=n.default.createElement(o.Input,{id:"input",name:"input",label:n.default.createElement("span",null,"Message input ",n.default.createElement("small",null,"(optional)")),help:"Select the message input ID that should be assigned to the parsed message."},n.default.createElement(u.Select,{id:"input",placeholder:"Select input",options:this._formatInputSelectOptions(),matchProp:"label",onValueChange:this._onInputSelect,value:this.state.inputId}))),n.default.createElement(i.Row,null,n.default.createElement(i.Col,{md:7},n.default.createElement("form",{onSubmit:this._loadMessage},n.default.createElement("fieldset",null,n.default.createElement(o.Input,{id:"message",name:"message",type:"textarea",label:"Raw message",value:this.state.message,onChange:this._bindValue,rows:3,required:!0}),n.default.createElement(o.Input,{id:"remoteAddress",name:"remoteAddress",type:"text",label:n.default.createElement("span",null,"Source IP address ",n.default.createElement("small",null,"(optional)")),help:"Remote IP address to use as message source. Graylog will use "+this.DEFAULT_REMOTE_ADDRESS+" by default.",value:this.state.remoteAddress,onChange:this._bindValue})),s,n.default.createElement("fieldset",null,n.default.createElement("legend",null,"Codec configuration"),n.default.createElement(o.Input,{id:"codec",name:"codec",label:"Message codec",help:"Select the codec that should be used to decode the message.",required:!0},n.default.createElement(u.Select,{id:"codec",placeholder:"Select codec",options:this._formatSelectOptions(),matchProp:"label",onValueChange:this._onCodecSelect,value:this.state.codec})),t),n.default.createElement(i.Button,{type:"submit",bsStyle:"info",disabled:this._isSubmitDisabled()},this.state.loading?"Loading message...":"Load message"))))}});exports.default=_,e.exports=exports.default},1150:function(e,exports,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),n=a(s),r=t(1019),l=a(r),i=t(5),o=a(i),u=t(18),d=a(u),c=d.default.getStore("UniversalSearch"),p=n.default.createClass({displayName:"RecentMessageLoader",propTypes:{inputs:s.PropTypes.object,onMessageLoaded:s.PropTypes.func.isRequired,selectedInputId:s.PropTypes.string},getInitialState:function(){return{loading:!1}},onClick:function(e){var t=this;this.props.inputs.get(e)||o.default.error("Invalid input selected: "+e,"Could not load message from invalid Input "+e),this.setState({loading:!0});var a=c.search("relative","gl2_source_input:"+e+" OR gl2_source_radio_input:"+e,{range:3600},void 0,1,void 0,void 0,void 0,!1);a.then(function(e){e.total_results>0?t.props.onMessageLoaded(e.messages[0]):(o.default.error("Input did not return a recent message."),t.props.onMessageLoaded(void 0))}),a.finally(function(){return t.setState({loading:!1})})},render:function(){var e=void 0;return e=this.props.selectedInputId?'Click on "Load Message" to load the most recent message received by this input within the last hour.':'Select an Input from the list below and click "Load Message" to load the most recent message received by this input within the last hour.',n.default.createElement("div",{style:{marginTop:5}},e,n.default.createElement(l.default,{inputs:this.props.inputs,preselectedInputId:this.props.selectedInputId,onLoadMessage:this.onClick,title:this.state.loading?"Loading message...":"Load Message",disabled:this.state.loading}))}});exports.default=p,e.exports=exports.default},1174:function(e,exports,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),n=a(s),r=t(165),l=a(r),i=t(1096),o=a(i),u=t(1095),d=a(u),c=t(18),p=a(c),m=t(5),f=a(m),h=p.default.getStore("StreamRules"),g=n.default.createClass({displayName:"StreamRule",propTypes:{matchData:n.default.PropTypes.array,onDelete:n.default.PropTypes.func,onSubmit:n.default.PropTypes.func,permissions:n.default.PropTypes.array.isRequired,stream:n.default.PropTypes.object.isRequired,streamRule:n.default.PropTypes.object.isRequired,streamRuleTypes:n.default.PropTypes.array.isRequired},mixins:[l.default],_onEdit:function(e){e.preventDefault(),this.refs.streamRuleForm.open()},_onDelete:function(e){var t=this;e.preventDefault(),window.confirm("Do you really want to delete this stream rule?")&&h.remove(this.props.stream.id,this.props.streamRule.id,function(){t.props.onDelete&&t.props.onDelete(t.props.streamRule.id),f.default.success("Stream rule has been successfully deleted.","Success")})},_onSubmit:function(e,t){var a=this;h.update(this.props.stream.id,e,t,function(){a.props.onSubmit&&a.props.onSubmit(e,t),f.default.success("Stream rule has been successfully updated.","Success")})},_formatActionItems:function(){return n.default.createElement("span",null,n.default.createElement("a",{href:"#",onClick:this._onDelete,style:{marginRight:5}},n.default.createElement("i",{className:"fa fa-trash-o"})),n.default.createElement("a",{href:"#",onClick:this._onEdit,style:{marginRight:5}},n.default.createElement("i",{className:"fa fa-edit"})))},_getMatchDataClassNames:function(){return this.props.matchData.rules[this.props.streamRule.id]?"alert-success":"alert-danger"},render:function(){var e=this.props.streamRule,t=this.props.streamRuleTypes,a=this.isPermitted(this.props.permissions,["streams:edit:"+this.props.stream.id])?this._formatActionItems():null,s=this.props.matchData?this._getMatchDataClassNames():null,r=this.props.streamRule.description?n.default.createElement("small",null," ","(",this.props.streamRule.description,")"):null;return n.default.createElement("li",{className:s},a,n.default.createElement(d.default,{streamRule:e,streamRuleTypes:t}),n.default.createElement(o.default,{ref:"streamRuleForm",streamRule:e,streamRuleTypes:t,title:"Edit Stream Rule",onSubmit:this._onSubmit}),r)}});exports.default=g,e.exports=exports.default},1175:function(e,exports,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),n=a(s),r=t(1174),l=a(r),i=t(48),o=n.default.createClass({displayName:"StreamRuleList",propTypes:{matchData:n.default.PropTypes.object,onSubmit:n.default.PropTypes.func,onDelete:n.default.PropTypes.func,permissions:n.default.PropTypes.array.isRequired,stream:n.default.PropTypes.object.isRequired,streamRuleTypes:n.default.PropTypes.array.isRequired},_formatStreamRules:function(e){var t=this;return e&&e.length>0?e.map(function(e){return n.default.createElement(l.default,{key:e.id,permissions:t.props.permissions,matchData:t.props.matchData,onSubmit:t.props.onSubmit,onDelete:t.props.onDelete,stream:t.props.stream,streamRule:e,streamRuleTypes:t.props.streamRuleTypes})}):n.default.createElement("li",null,"No rules defined.")},render:function(){if(this.props.stream){var e=this._formatStreamRules(this.props.stream.rules);return n.default.createElement("ul",{className:"streamrules-list"},e)}return n.default.createElement(i.Spinner,null)}});exports.default=o,e.exports=exports.default},1301:function(e,exports,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),n=a(s),r=t(15),l=t(949),i=t(75),o=a(i),u=t(1148),d=a(u),c=t(1302),p=a(c),m=t(1175),f=a(m),h=t(1096),g=a(h),y=t(260),E=a(y),b=t(18),_=a(b),T=_.default.getStore("Streams"),v=_.default.getStore("StreamRules"),S=n.default.createClass({displayName:"StreamRulesEditor",propTypes:function(){return{currentUser:s.PropTypes.object.isRequired,streamId:s.PropTypes.string.isRequired,messageId:s.PropTypes.string,index:s.PropTypes.string}},getInitialState:function(){return{}},componentDidMount:function(){this.loadData(),T.onChange(this.loadData),v.onChange(this.loadData)},componentWillUnmount:function(){T.unregister(this.loadData),v.unregister(this.loadData)},onMessageLoaded:function(e){var t=this;this.setState({message:e}),void 0!==e?T.testMatch(this.props.streamId,{message:e.fields},function(e){t.setState({matchData:e})}):this.setState({matchData:void 0})},loadData:function(){var e=this;v.types().then(function(t){e.setState({streamRuleTypes:t})}),T.get(this.props.streamId,function(t){e.setState({stream:t})}),this.state.message&&this.onMessageLoaded(this.state.message)},_onStreamRuleFormSubmit:function(e,t){v.create(this.props.streamId,t,function(){})},_onAddStreamRule:function(e){e.preventDefault(),this.refs.newStreamRuleForm.open()},_getListClassName:function(e){return e.matches?"success":"danger"},_explainMatchResult:function(){return this.state.matchData?this.state.matchData.matches?n.default.createElement("span",null,n.default.createElement("i",{className:"fa fa-check",style:{color:"green"}})," This message would be routed to this stream."):n.default.createElement("span",null,n.default.createElement("i",{className:"fa fa-remove",style:{color:"red"}})," This message would not be routed to this stream."):"Please load a message to check if it would match against these rules and therefore be routed into this stream."},render:function(){var e=this.state.matchData?this._getListClassName(this.state.matchData):"info";return this.state.stream&&this.state.streamRuleTypes?n.default.createElement("div",{className:"row content"},n.default.createElement("div",{className:"col-md-12 streamrule-sample-message"},n.default.createElement("h2",null,"1. Load a message to test rules"),n.default.createElement("div",{className:"stream-loader"},n.default.createElement(d.default,{messageId:this.props.messageId,index:this.props.index,onMessageLoaded:this.onMessageLoaded})),n.default.createElement("div",{className:"spinner",style:{display:"none"}},n.default.createElement("h2",null,n.default.createElement("i",{className:"fa fa-spinner fa-spin"}),"  Loading message")),n.default.createElement("div",{className:"sample-message-display",style:{display:"none",marginTop:"5px"}},n.default.createElement("strong",null,"Next step:"),"Add/delete/modify stream rules in step 2 and see if the example message would have been routed into the stream or not. Use the button on the right to add a stream rule."),n.default.createElement("hr",null),n.default.createElement("div",{className:"buttons pull-right"},n.default.createElement("button",{className:"btn btn-success show-stream-rule",onClick:this._onAddStreamRule},"Add stream rule"),n.default.createElement(g.default,{ref:"newStreamRuleForm",title:"New Stream Rule",streamRuleTypes:this.state.streamRuleTypes,onSubmit:this._onStreamRuleFormSubmit})),n.default.createElement("h2",null,"2. Manage stream rules"),this._explainMatchResult(),n.default.createElement(p.default,{stream:this.state.stream,onChange:this.loadData}),n.default.createElement(r.Alert,{ref:"well",bsStyle:e},n.default.createElement(f.default,{stream:this.state.stream,streamRuleTypes:this.state.streamRuleTypes,permissions:this.props.currentUser.permissions,matchData:this.state.matchData})),n.default.createElement("p",{style:{marginTop:"10px"}},n.default.createElement(l.LinkContainer,{to:o.default.STREAMS},n.default.createElement(r.Button,{bsStyle:"success"},"I'm done!"))))):n.default.createElement("div",{className:"row content"},n.default.createElement("div",{style:{marginLeft:10}},n.default.createElement(E.default,null)))}});exports.default=S,e.exports=exports.default},1302:function(e,exports,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var l=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),i=t(2),o=a(i),u=t(43),d=t(18),c=a(d),p=t(5),m=a(p),f=c.default.getStore("Streams"),h=function(e){function t(){return s(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),l(t,[{key:"render",value:function(){return o.default.createElement("div",{className:"streamrule-connector-type-form"},o.default.createElement("div",null,o.default.createElement(u.Input,{type:"radio",label:"A message must match all of the following rules",checked:"AND"===this.props.stream.matching_type,onChange:this.handleTypeChangeToAnd.bind(this)}),o.default.createElement(u.Input,{type:"radio",label:"A message must match at least one of the following rules",checked:"OR"===this.props.stream.matching_type,onChange:this.handleTypeChangeToOr.bind(this)})))}},{key:"handleTypeChangeToAnd",value:function(){this.handleTypeChange("AND")}},{key:"handleTypeChangeToOr",value:function(){this.handleTypeChange("OR")}},{key:"handleTypeChange",value:function(e){var t=this;window.confirm("You are about to change how rules are applied to this stream, do you want to continue? Changes will take effect immediately.")&&f.update(this.props.stream.id,{matching_type:e},function(a){return t.props.onChange(),m.default.success("Messages will now be routed into the stream when "+("AND"===e?"all":"any")+" rules are matched","Success"),a})}}]),t}(i.Component);h.propTypes={stream:i.PropTypes.object.isRequired,onChange:i.PropTypes.func.isRequired},exports.default=h,e.exports=exports.default},1408:function(e,exports,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),n=a(s),r=t(1),l=a(r),i=t(15),o=t(1301),u=a(o),d=t(48),c=t(18),p=a(c),m=p.default.getStore("CurrentUser"),f=p.default.getStore("Streams"),h=n.default.createClass({displayName:"StreamEditPage",propTypes:{params:s.PropTypes.object.isRequired,location:s.PropTypes.object.isRequired},mixins:[l.default.connect(m)],componentDidMount:function(){var e=this;f.get(this.props.params.streamId,function(t){e.setState({stream:t})})},_isLoading:function(){return!this.state.currentUser||!this.state.stream},render:function(){if(this._isLoading())return n.default.createElement(d.Spinner,null);var e=n.default.createElement(u.default,{currentUser:this.state.currentUser,streamId:this.props.params.streamId,messageId:this.props.location.query.message_id,index:this.props.location.query.index});return this.state.stream.is_default&&(e=n.default.createElement("div",{className:"row content"},n.default.createElement("div",{className:"col-md-12"},n.default.createElement(i.Alert,{bsStyle:"danger"},"The default stream cannot be edited.")))),n.default.createElement(d.DocumentTitle,{title:"Rules of Stream "+this.state.stream.title},n.default.createElement("div",null,n.default.createElement(d.PageHeader,{title:n.default.createElement("span",null,"Rules of Stream »",this.state.stream.title,"»")},n.default.createElement("span",null,"This screen is dedicated to an easy and comfortable creation and manipulation of stream rules. You can"," ","see the effect configured stream rules have on message matching here.")),e))}});exports.default=h,e.exports=exports.default},961:function(e,exports,t){e.exports=t(10)(336)},989:function(e,exports,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(2),n=a(s),r=t(7),l=a(r),i=t(18),o=a(i),u=l.default.getActions("Messages"),d=(o.default.getStore("Messages"),n.default.createClass({displayName:"MessageLoader",propTypes:{hidden:s.PropTypes.bool,hideText:s.PropTypes.bool,onMessageLoaded:s.PropTypes.func},getDefaultProps:function(){return{hidden:!0}},getInitialState:function(){return{hidden:this.props.hidden,loading:!1}},toggleMessageForm:function(){this.setState({hidden:!this.state.hidden},this._focusMessageLoaderForm)},_focusMessageLoaderForm:function(){this.state.hidden||this.refs.messageId.focus()},loadMessage:function(e){var t=this,a=this.refs.messageId.value,s=this.refs.index.value;if(""!==a&&""!==s){this.setState({loading:!0});var n=u.loadMessage.triggerPromise(s,a);n.then(function(e){return t.props.onMessageLoaded(e)}),n.finally(function(){return t.setState({loading:!1})}),e.preventDefault()}},submit:function(e,t){this.refs.messageId.value=e,this.refs.index.value=t,this.refs.submitButton.click()},render:function(){var e=void 0;this.props.hideText||(e=n.default.createElement("p",null,"Wrong example? You can"," ",n.default.createElement("button",{className:"btn btn-link btn-small btn-text",onClick:this.toggleMessageForm},"load another message"),"."));var t=n.default.createElement("div",null,n.default.createElement("form",{className:"form-inline message-loader-form",onSubmit:this.loadMessage},n.default.createElement("input",{type:"text",ref:"messageId",className:"form-control message-id-input",placeholder:"Message ID",required:!0}),n.default.createElement("input",{type:"text",ref:"index",className:"form-control",placeholder:"Index",required:!0}),n.default.createElement("button",{ref:"submitButton",type:"submit",className:"btn btn-info",disabled:this.state.loading},this.state.loading?"Loading message...":"Load message")));return n.default.createElement("div",{className:"message-loader"},e,this.state.hidden?null:t)}}));exports.default=d,e.exports=exports.default}});
//# sourceMappingURL=26.200197dca04f05abe3f2.js.map